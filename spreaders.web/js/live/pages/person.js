spreaders.pages.person=function(){var b=function(a,c,b,e){var d=this;this.pageContext=a;this.storage=c;this.urlService=b;this.synchroniser=e;this.person;this.colours="#f3a683 #f7d794 #778beb #e77f67 #cf6a87 #e66767 #63cdda #f8a5c2 #786fa6 #596275".split(" ");this.name=document.getElementsByName("name")[0];this.colour=document.getElementsByName("colour")[0];this.firstLetter=document.getElementsByClassName("firstLetter")[0];this.changeIconButton=document.getElementsByClassName("changeIcon")[0];this.iconSelection=
document.getElementsByClassName("iconSelection")[0];this.iconSelectionList=document.getElementsByClassName("iconSelectionList")[0];this.updateButton=document.getElementsByClassName("submit")[0];this.populateBackButton();this.changeIconButton.addEventListener("click",this.handleChangeIconClick.bind(this));this.iconSelectionList.addEventListener("click",this.handleIconListClick.bind(this));this.updateButton.addEventListener("click",this.processUpdateButtonClick.bind(this));a=this.pageContext.getCurrentPerson();
this.storage.getPerson(a).then(function(a){d.person=a;d.populateForm();d.populateIcons()});this.synchroniser.startServiceWorker()};b.prototype.populateBackButton=function(){document.getElementsByClassName("backButton")[0].href=this.urlService.getPeoplePage(this.pageContext.getCurrentGroupId())};b.prototype.populateForm=function(){this.name.value=this.person.name;this.colour.value=this.person.colour;this.firstLetter.innerHTML=this.person.name.charAt(0);this.firstLetter.style.backgroundColor=this.person.colour};
b.prototype.handleChangeIconClick=function(a){a.preventDefault();this.iconSelection.classList.contains("active")?this.iconSelection.className="iconSelection":this.iconSelection.className="iconSelection active"};b.prototype.populateIcons=function(){for(var a=0;a<this.colours.length;a++){var b=this.createIcon(this.colours[a]);this.iconSelectionList.appendChild(b)}};b.prototype.createIcon=function(a){var b=document.createElement("li");b.classList=a==this.person.colour?"firstLetter active":"firstLetter";
b.setAttribute("data-colour",a);b.style.backgroundColor=a;b.innerText=this.person.name.charAt(0);return b};b.prototype.handleIconListClick=function(a){a.target&&"LI"==a.target.nodeName&&(document.getElementsByClassName("firstLetter active")[0].className="firstLetter",a.target.className="firstLetter active",a=a.target.getAttribute("data-colour"),this.colour.value=a,this.firstLetter.style.backgroundColor=a)};b.prototype.processUpdateButtonClick=function(){var a=this;this.person.name=this.name.value;
this.person.colour=this.colour.value;this.person.updatedOn=this.storage.getUtcUnixTimeStamp();this.storage.updatePerson(this.person,!0).then(function(){a.synchroniser.syncWithServer();window.location.href=a.urlService.getPeoplePage(a.pageContext.getCurrentGroupId())})};return b}();var storage=new spreaders.storage;
storage.connect().then(function(b){b=new spreaders.urlService;var a=new spreaders.pageContext(b),c=new spreaders.apiService;c=new spreaders.sync.synchroniser(storage,c);new spreaders.pages.person(a,storage,b,c)});
